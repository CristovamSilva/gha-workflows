name: Reusable Test
on:
  workflow_call:
    inputs:
      module-directory:
        description: What folder to analyze
        required: true
        type: string

jobs:
  TestAndCoverage:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Load Cache & Dependencies
        uses: ./.github/actions/cache-dependencies

      - name: Test Module
        run: pytest ${{ inputs.module-directory }} --cov=${{ inputs.module-directory }}

      # - name: Upload pytest test results
      #   uses: actions/upload-artifact@v3
      #   with:
      #     name: pytest-results
      #     path: junit/test-results.xml
      #   if: ${{ always() }}

  # Coverage:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout Repository
  #       uses: actions/checkout@v3

  #     - name: Load Cache & Dependencies
  #       uses: ./.github/actions/cache-dependencies

  #     - name: Verify Coverage with pytest-cov
  #       run: pytest --cov=${{ inputs.module-directory }}

  # - name: Verify Coverage with coverage
  #   run: coverage run -m pytest ${{ inputs.module-directory }}
